<a id="anchor"></a>
# __Теория:__


Случайное блуждание - это случайный процесс(СП), который описывает путь, состоящий из последовательности случайных шагов в каком-нибудь математическом пространстве(например, на множестве целых чисел).
Простейшим примером случайного блуждания является случайное блуждание по числовой прямой целых чисел, которое начинается в точке 0 и на каждом шаге сдвигается на +1 или на -1 с равной вероятностью.


Одной из моделей случайных блужданий является винеровский процесс - случайный процесс, служащий математической моделью броуновского движения. Винеровский процесс определяется как случайный процесс $x\left(t\right)$ с непрерывным временем $t$, с $x\left(0\right)=0,$ приращения которого за непересекающиеся промежутки времени взаимно независимы, при этом $x\left(t+\Delta t\right)-x\left(t\right)$ при любом $t$ имеет нормальное распределения с нулевым математическим ожиданием и дисперсией $\Delta t$.
Для задания процесса со случайными блужданиями необходимо рекурсивно генерировать последовательность:


$$\left.x\lbrack n\right\rbrack =x\left\lbrack n-1\right\rbrack +\omega \left\lbrack n\right\rbrack ,$$

где $\omega \left\lbrack n\right\rbrack =\textrm{normrnd}\left(\mu ,\sigma \right)\ldotp$

Случайные блуждания с поглощением являются стационарным СП и могут быть заданы следующим выражением:

$$\left.x\lbrack n\right\rbrack =0,9x\left\lbrack n-1\right\rbrack +\omega \left\lbrack n\right\rbrack \ldotp$$

Стационарный процесс - это стохастический процесс, у которого не изменяются распределения вероятности при смещении во времени.
Так как случайные блуждания с поглащением являются стационарным для больших значений $n$, среднее по времени должно быть равно среднему по ансамблю. Тогда автокорреляция может быть рассчитана по одной реализации:

$$\hat{r_x } \left(l\right)=\frac{1}{N}\sum_{n=1}^N x\left\lbrack n\right\rbrack x\left\lbrack n-1\right\rbrack \ldotp$$ 
   
# __Алгоритм выполнения__

1. Сгенерируйте матрицу $X^{N\times K}$ с $K$ реализациями случайного процесса $x[n],n=1,\ldots,N$, представляющего собой винеровский процесс.

```
% Исходные данные
N = 500; % количество временных шагов
K = 1000; % количество реализаций
M = 0; % математическое ожидание
D = 1; % дисперсия
sigma = sqrt(D); % стандартное отклонение

X = zeros(N,K); % инициализация матрицы X
omega = zeros(N,K); % инициализация матрицы шума omega
n = 1:N; % вектор временных шагов

% Генерация шума omega
for i = 1:N
    for j = 1:K
        omega(i,j) = normrnd(M,sigma); % генерация случайного числа из нормального распределения
    end
end

% Вычисление значений X
for i = 2:N
    for j = 1:K
        X(1,j) = 0; % начальное значение X
        X(i,j) = X(i-1,j) + omega(i,j); % вычисление следующего значения X
    end
end
```
   
3. Постройте график всех реализация на одном рисунке.
```
% График всех реализаций
figure('Name', 'График всех реализаций');
plot(n,X,'b');
title('График всех реализаций');
```
![untitled](https://github.com/goldencalf26/RandomWalk/assets/115105233/48057ad1-8a71-497d-9020-05dbf1b7759c)

   
5. Сгенерируйте диаграммы рассеяния (скаттерограммы) для пар $x\left\lbrack n_i \right\rbrack \;\textrm{и}\;x\left\lbrack n_j \right\rbrack$.

```
% Диаграммы рассеивания
figure('Name','Диаграммы рассеивания');
subplot(2,3,1)
hold on
plot(X(50,:),X(49,:),'o');
axis equal
title('ni = 50; nj = 49');

subplot(2,3,2)
plot(X(100,:),X(99,:),'o');
axis equal
title('ni = 100; nj = 99');

subplot(2,3,3)
hold on
plot(X(200,:),X(199,:),'o');
title('ni = 200; nj = 199');

subplot(2,3,4)
hold on
plot(X(50,:),X(40,:),'o');
axis equal
title('ni = 50; nj = 40');

subplot(2,3,5)
plot(X(100,:),X(90,:),'o');
axis equal
title('ni = 100; nj = 90');

subplot(2,3,6)
plot(X(200,:),X(190,:),'o');
axis equal
title('ni = 200; nj = 190');
hold off
```

![untitled1](https://github.com/goldencalf26/RandomWalk/assets/115105233/a439fcb1-f0ea-4f9f-a4bc-127929732829)

Диаграммы рассеяния используются для демонстрации наличия или отсутствия корреляции между двумя переменными. Поэтому, в нашем случае, разницу в диаграммах можно объяснить тем, что у соседних строк корреляция выражена лучше.

4. Рассчитайте выборочную корреляцию по ансамблю ${\hat{r} }_x \left(n,n-1\right)$.

```
% Вычисление выборочной корреляции по ансамблю
r = zeros(1,N); % инициализация массива корреляций
for i = 2:N
    r(i) = sum(X(i,:).*X(i-1,:))./K; % вычисление корреляции между i-ым и (i-1)-ым временным шагами
end

% График выборочной корреляции по ансамблю
figure('Name', 'Выборочная корреляция по ансамблю');
plot(n,r);
title('Выборочная корреляция по ансамблю');
```
![untitled2](https://github.com/goldencalf26/RandomWalk/assets/115105233/6bd81343-b025-43d9-b1db-2d676bf9cb38)

   
6. Сгенерируйте матрицу $X^{N\times K}$ с $K$ реализациями случайного процесса $x[n],n=1,\ldots,N$, представляющего собой случайные блуждания с поглощением. Выполните пункты 2-4.

```
% Исходные данные
N = 500; % количество временных шагов
K = 1000; % количество реализаций
M = 0; % математическое ожидание
D = 1; % дисперсия
sigma = sqrt(D); % стандартное отклонение

X = zeros(N,K); % инициализация матрицы X
omega = zeros(N,K); % инициализация матрицы шума omega
n = 1:N; % вектор временных шагов

% Генерация шума omega
for i = 1:N
    for j = 1:K
        omega(i,j) = normrnd(M,sigma); % генерация случайного числа из нормального распределения
    end
end

% Вычисление значений X
for i = 2:N
    for j = 1:K
        X(1,j) = 0; % начальное значение X
        X(i,j) = 0.9.*X(i-1,j) + omega(i,j); % вычисление следующего значения X с учетом коэффициента 0.9
    end
end

% График всех реализаций
figure('Name', 'График всех реализаций');
plot(n,X,'b');
title('График всех реализаций');

% Диаграммы рассеивания
figure('Name','Диаграммы рассеивания');
subplot(2,3,1)
hold on
plot(X(50,:),X(49,:),'o');
axis equal
title('ni = 50; nj = 49');

subplot(2,3,2)
plot(X(100,:),X(99,:),'o');
axis equal
title('ni = 100; nj = 99');

subplot(2,3,3)
hold on
plot(X(200,:),X(199,:),'o');
title('ni = 200; nj = 199');

subplot(2,3,4)
hold on
plot(X(50,:),X(40,:),'o');
axis equal
title('ni = 50; nj = 40');

subplot(2,3,5)
plot(X(100,:),X(90,:),'o');
axis equal
title('ni = 100; nj = 90');

subplot(2,3,6)
plot(X(200,:),X(190,:),'o');
axis equal
title('ni = 200; nj = 190');
hold off

% Вычисление выборочной корреляции по ансамблю
r = zeros(1,N); % инициализация массива корреляций
for i = 2:N
    r(i) = sum(X(i,:).*X(i-1,:))./K; % вычисление корреляции между i-ым и (i-1)-ым временным шагами
end

% График выборочной корреляции по ансамблю
figure('Name', 'Выборочная корреляция по ансамблю');
plot(n,r);
title('Выборочная корреляция по ансамблю');
```
![untitled](https://github.com/goldencalf26/RandomWalk/assets/115105233/64b7b6d4-4263-4e7c-9ad8-1fca194f75ec)

![untitled1](https://github.com/goldencalf26/RandomWalk/assets/115105233/542cc5c5-7be5-4d27-89e8-99b5e1e6cfc5)

![untitled2](https://github.com/goldencalf26/RandomWalk/assets/115105233/5d24a235-228c-4718-9ab0-ce47cf4cccb3)

[В начало](#anchor)
